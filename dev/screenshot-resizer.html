<!DOCTYPE html>
<html>
<head>
    <title>Chrome Web Store Screenshot Resizer</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .container { background: #f9f9f9; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        button { background: #4285f4; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #3367d6; }
        canvas { border: 1px solid #ddd; margin: 10px 0; }
        .download-link { display: inline-block; background: #34a853; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; margin: 5px; }
        .requirements { background: #e3f2fd; padding: 15px; border-radius: 4px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>üñºÔ∏è Chrome Web Store Screenshot Resizer</h1>
    
    <div class="requirements">
        <h3>Chrome Web Store Requirements:</h3>
        <ul>
            <li>Size: 1280x800 or 640x400 pixels</li>
            <li>Format: JPEG or PNG (no transparency)</li>
            <li>Maximum: 5 screenshots</li>
        </ul>
    </div>

    <div class="container">
        <h3>Upload Your Screenshot</h3>
        <input type="file" id="imageInput" accept="image/*">
        <button onclick="loadImage()">Load Image</button>
    </div>

    <div id="previewContainer" style="display:none;">
        <div class="container">
            <h3>Original Image</h3>
            <img id="originalImg" style="max-width: 100%; height: auto;">
            <div id="originalInfo"></div>
        </div>

        <div class="container">
            <h3>Generate Chrome Web Store Screenshots</h3>
            <button onclick="resizeImage(1280, 800, 'large')">Generate 1280x800</button>
            <button onclick="resizeImage(640, 400, 'compact')">Generate 640x400</button>
        </div>

        <div id="outputContainer"></div>
    </div>

    <script>
        let originalImage = null;

        function loadImage() {
            const input = document.getElementById('imageInput');
            const file = input.files[0];
            
            if (!file) {
                alert('Please select an image file');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    originalImage = img;
                    displayOriginal(img, file);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function displayOriginal(img, file) {
            const originalImg = document.getElementById('originalImg');
            const originalInfo = document.getElementById('originalInfo');
            const previewContainer = document.getElementById('previewContainer');

            originalImg.src = img.src;
            originalInfo.innerHTML = `
                <strong>Dimensions:</strong> ${img.width} √ó ${img.height} pixels<br>
                <strong>File Size:</strong> ${formatFileSize(file.size)}
            `;

            previewContainer.style.display = 'block';
        }

        function resizeImage(targetWidth, targetHeight, sizeName) {
            if (!originalImage) return;

            // Create canvas
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = targetWidth;
            canvas.height = targetHeight;

            // Calculate scaling to maintain aspect ratio and center the image
            const scale = Math.min(targetWidth / originalImage.width, targetHeight / originalImage.height);
            const scaledWidth = originalImage.width * scale;
            const scaledHeight = originalImage.height * scale;
            
            const offsetX = (targetWidth - scaledWidth) / 2;
            const offsetY = (targetHeight - scaledHeight) / 2;

            // Fill with white background
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, targetWidth, targetHeight);

            // Draw scaled image
            ctx.drawImage(originalImage, offsetX, offsetY, scaledWidth, scaledHeight);

            // Convert to blob and create download
            canvas.toBlob(function(blob) {
                createDownload(blob, `vstat-screenshot-${targetWidth}x${targetHeight}.jpg`, canvas, sizeName);
            }, 'image/jpeg', 0.95);
        }

        function createDownload(blob, filename, canvas, sizeName) {
            const outputContainer = document.getElementById('outputContainer');
            
            // Create container for this size
            let sizeContainer = document.getElementById(`container-${sizeName}`);
            if (!sizeContainer) {
                sizeContainer = document.createElement('div');
                sizeContainer.id = `container-${sizeName}`;
                sizeContainer.className = 'container';
                sizeContainer.innerHTML = `<h3>${sizeName.charAt(0).toUpperCase() + sizeName.slice(1)} Size (${canvas.width}x${canvas.height})</h3>`;
                outputContainer.appendChild(sizeContainer);
            }

            // Add preview canvas
            const previewCanvas = canvas.cloneNode();
            const ctx = previewCanvas.getContext('2d');
            ctx.drawImage(canvas, 0, 0);
            previewCanvas.style.maxWidth = '100%';
            previewCanvas.style.height = 'auto';
            previewCanvas.style.border = '1px solid #ddd';
            
            sizeContainer.appendChild(previewCanvas);

            // Create download link
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.className = 'download-link';
            link.textContent = `üì• Download ${filename}`;
            
            sizeContainer.appendChild(document.createElement('br'));
            sizeContainer.appendChild(link);

            console.log(`Generated ${canvas.width}x${canvas.height} screenshot`);
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
    </script>
</body>
</html>